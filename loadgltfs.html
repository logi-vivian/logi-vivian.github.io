<!doctype HTML>
<html>
<head>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
        #testtext {color: white; font-family: 'Poppins', sans-serif;}


    </style>
    <link href="https://fonts.googleapis.com/css?family=Poppins&display=swap" rel="stylesheet">

</head>

<script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script>
<script src="https://rawgit.com/jeromeetienne/AR.js/1.7.5/aframe/build/aframe-ar.min.js"></script>

<script src="https://unpkg.com/aframe-particleplayer-component/dist/aframe-particleplayer-component.min.js"></script>


<script>

    THREEx.ArToolkitContext.baseURL = 'https://rawgit.com/jeromeetienne/ar.js/master/three.js/';
    AFRAME.registerComponent("foo", {
        init: function() {
            this.el.addEventListener("click", (e)=>{console.log("HELLO")})
        }
    })

    AFRAME.registerComponent('trigger', {
        init: function() {
            document.addEventListener('keydown', evt => {
                if (evt.keyCode === 32) { this.trigger(); }
            });
            document.addEventListener('click', () => {
                this.trigger();
            });
        },

        trigger: function() {
            console.log(this.el);
            this.el.emit('particleplayerstart', {
                zIndex: 100,
                position: new THREE.Vector3(
                    (Math.random() - 0.5) * 7,
                    Math.random() * 2,
                    -5 - Math.random() * 2
                ),
                rotation: new THREE.Euler(Math.random() * 1 - .5, 0, 0)
            });
        }
    });


    AFRAME.registerComponent('registerevents', {
        init: function () {
            var marker = this.el;



            marker.addEventListener('markerFound', function() {
                var markerId = marker.id;
                console.log('markerFound', markerId);
                text = marker.children[0];

                // document.getElementById("modal").style.backgroundColor = colors[index % 4];
                index+=1;

                // document.getElementById("infoImg").src = text.getAttribute('data-infoImgSrc');




                document.getElementById("testtext").innerText = text.getAttribute('data-textValue');



            });
            marker.addEventListener('markerLost', function() {

            });
        }
    });


</script>

<body style='margin : 0; overflow: hidden;'>

<button onclick="goDown()" style="position: absolute; background-color: rgba(0,0,0,0); left: 20%; top: 50%; z-index: 3;">DOWN</button>

<button onclick="registeredClick()" style="position: absolute; background-color: rgba(0,0,0,0); right: 20%; bottom: 20%; z-index: 3;"><img width="150px" src="recyclelogo.png"></button>

<script>
    function registeredClick() {

        let camera = document.querySelector("#camera");
        console.log(camera);
        camera.setAttribute('animation', 'property: position; to: ' + camera.getAttribute('position').x + ' ' + (camera.getAttribute('position').y + 1) + ' ' + camera.getAttribute('position').z);



    }

    function goDown() {

        let camera = document.querySelector("#camera");
        console.log(camera);
        camera.setAttribute('animation', 'property: position; to: ' + camera.getAttribute('position').x + ' ' + (camera.getAttribute('position').y - 1) + ' ' + camera.getAttribute('position').z);



    }
</script>

<!-- we add detectionMode and matrixCodeType to tell AR.js to recognize barcode markers -->
<a-scene id="scene" cursor="rayOrigin: mouse" vr-mode-ui="enabled: false" embedded arjs='sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;'>
    <a-camera id="camera" position="0 0 4">

    </a-camera>

    <a-sky color="#000">

    </a-sky>
    <a-assets>
        <a-asset-item id="future" src="./gltfs/thelongtomorrow/model.gltf"></a-asset-item>
    </a-assets>

    <a-assets>
        <a-asset-item id="stairs" src="./gltfs/rainbowstairs/model.gltf"></a-asset-item>
    </a-assets>

    <a-assets>
        <a-asset-item id="gameboy" src="./gltfs/gameboy/handheld.gltf"></a-asset-item>
    </a-assets>

    <a-assets>
        <a-asset-item id="paradiselost" src="./gltfs/paradiselostedited.gltf"></a-asset-item>
    </a-assets>


    <a-assets>
        <a-asset-item id="fan" src="./gltfs/atticfan/Attic Fan 2.gltf" scale="0.000001 0.000001 0.000001"></a-asset-item>
    </a-assets>

    <a-assets>
        <a-asset-item id="monitor" src="./gltfs/monitor/Monitor.gltf" scale="0.000001 0.000001 0.000001"></a-asset-item>
    </a-assets>

    <a-assets>
        <a-asset-item id="particlesJson" src="./particles-fireworks.json"></a-asset-item>
        <img src="./sprite.png" id="particleTex">
    </a-assets>


    <a-entity  gltf-model="#future" color="white"  position="1 0 0" scale="0.9 0.9 0.9"></a-entity>
    <a-entity  trigger
               particleplayer="on: particleplayerstart; src: #particlesJson; img: #particleTex; dur: 4000; count: 50%; scale: 0.6; pscale: 2; interpolate: true; shader: standard; poolSize: 20"

            animation__scale="property: scale; dir: alternate; dur: 2000;
                      easing: easeInSine; loop: true; to: 0.03 0.03 0.03" gltf-model="#gameboy"  position="0 0 0" scale="0.02 0.02 0.02"></a-entity>

    <a-entity gltf-model="#paradiselost"  rotation="0 25 -40 " position="0 6.5 -1" scale="0.5 0.5 0.5" ></a-entity>

    <a-entity animation__scale="property: scale; dir: alternate; dur: 2000;
                      easing: easeInSine; loop: true; to: 0.005 0.005 0.005" gltf-model="#monitor"  rotation= "0 20 0 " position="-0.5 2 0" scale="0.003 0.003 0.003"></a-entity>

    <a-entity   animation__scale="property: scale; dir: alternate; dur: 2000;
     easing: easeInSine; loop: true; to: 0.001 0.001 0.001"  gltf-model="#fan"  position="0.5 4 0" rotation="30 -40 0" scale="0.0006 0.0006 0.0006"></a-entity>


</a-scene>


</body>
</html>
