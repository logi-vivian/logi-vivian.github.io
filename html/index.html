<!doctype HTML>
<html>
<head>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
    #testtext {color: white; font-family: 'Poppins', sans-serif;}

     .textinput {
         margin: 20px;
         position: relative;
     }
    #map {
        height: 60%;
        display: flex;
        top: 15%;
        left: 25%;
        width: 60%;
        background-color: white;
        justify: center;
    }
    /* Optional: Makes the sample page fill the window. */
    html, body {
        font-family: 'Poppins', sans-serif;



        height: 100%;
        margin: 0;
        background-color: black;
        padding: 0;
    }


    </style>
    <link href="https://fonts.googleapis.com/css?family=Poppins&display=swap" rel="stylesheet">

</head>

<script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script>
<script src="https://rawgit.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.min.js"></script>
<script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
<script src="./aframe-particle-system-component/dist/aframe-particle-system-component.min.js"></script>
<script src="https://unpkg.com/aframe-particleplayer-component/dist/aframe-particleplayer-component.min.js"></script>


<script>
    var colors = ["#4dc9c3","#5559b0","#01b8ec", "#ff6e84"];
    var index = 0;

    var text;
    var newFog = document.createElement( 'div' );
    newFog.id = "fog";


    THREEx.ArToolkitContext.baseURL = 'https://rawgit.com/jeromeetienne/ar.js/master/three.js/';
    AFRAME.registerComponent("foo", {
        init: function() {
            this.el.addEventListener("click", (e)=>{console.log("HELLO")})
        }
    })

    AFRAME.registerComponent('trigger', {
        init: function() {
            document.addEventListener('keydown', evt => {
                if (evt.keyCode === 32) { this.trigger(); }
            });
            document.addEventListener('click', () => {
                this.trigger();
            });
        },

        trigger: function() {
            this.el.emit('particleplayerstart', {
                position: new THREE.Vector3(
                    (Math.random() - 0.5) * 7,
                    Math.random() * 2,
                    -5 - Math.random() * 2
                ),
                rotation: new THREE.Euler(Math.random() * 1 - .5, 0, 0)
            });
        }
    });


    AFRAME.registerComponent('registerevents', {
        init: function () {
            var marker = this.el;



            marker.addEventListener('markerFound', function() {
                var markerId = marker.id;
                console.log('markerFound', markerId);
                text = marker.children[0];

                // document.getElementById("modal").style.backgroundColor = colors[index % 4];
                index+=1;

                // document.getElementById("infoImg").src = text.getAttribute('data-infoImgSrc');




                document.getElementById("testtext").innerText = text.getAttribute('data-textValue');



            });
            marker.addEventListener('markerLost', function() {

            });
        }
    });


</script>

<body style='margin : 0; overflow: hidden;'>

<div id="modal" style='position: absolute; width:100%; height: 100%; overflow: hidden; background-color: black; opacity: 0.5; text-align: center; z-index: 0;'>
<a href="cards.html"> <p>x</p> </a>
    <p id="testtext">      This is test text.</p>
    <img src="" style="float: left;" id="infoImg" width="50%">


</div>


<button onclick="registeredClick()" style="position: absolute; background-color: rgba(0,0,0,0) left: 50%; top: 50%; z-index: 3;"><img src="recyclelogo.png"></button>

<script>
    var clicks = 0;
    var pollutionSystem = ["#pollution1", "#pollution2", "#pollution3", "#pollution4"];

    function registeredClick() {


        // if we have under click == 0 1 2 3

        if (clicks < pollutionSystem.length ) {

            var nextToRemove = document.querySelector(pollutionSystem[clicks]);
            nextToRemove.parentNode.removeChild(nextToRemove);
            console.log(nextToRemove);

            if (clicks == pollutionSystem.length - 1) {
                var stellarSystem = document.createElement('a-entity');
                stellarSystem.setAttribute('particle-system', {

                    color: "#0eeee",
                    particleCount: "100",
                    size: "10"
                });
                document.querySelector('#scene').appendChild(stellarSystem);
                console.log("adding new particle system");
            }

        } else {
            var win = window.open("https://www.logitech.com/en-us/sustainability/recycling.html", 'newwin');

        }

        clicks += 1;
        console.log(clicks);


    }
</script>


<!-- we add detectionMode and matrixCodeType to tell AR.js to recognize barcode markers -->
<a-scene id="scene" cursor="rayOrigin: mouse" vr-mode-ui="enabled: false" embedded arjs='sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;'>
    <a-camera position="0 0 4"></a-camera>


    <a-assets>
        <a-asset-item id="particlesJson" src="./particles-fireworks.json"></a-asset-item>
        <img src="./sprite.png" id="particleTex">
    </a-assets>


    <a-assets>
        <a-asset-item id="bowser" src="./bowser/scene.gltf" scale="0.00001 0.00001 0.00001"></a-asset-item>
    </a-assets>

        <a-assets>
            <a-asset-item id="lego" src="./lego/scene.gltf" scale="0.00001 0.00001 0.00001"></a-asset-item>
        </a-assets>

    <a-assets>
        <a-asset-item id="earth" src="./lowpolyearth/scene.gltf" scale="0.001 0.01 0.01"></a-asset-item>
    </a-assets>


    <a-entity position="0 1 -5"
              trigger
              particleplayer="on: particleplayerstart; src: #particlesJson; img: #particleTex; dur: 4000; count: 50%; scale: 0.6; pscale: 2; interpolate: true; shader: standard; poolSize: 20"></a-entity>


<!--    <a-entity position="0 2.25 -15" particle-system="preset: dust; texture: ./aframe-particle-systems-component/dist/images/star2.png; color: #0000FF,#00FF00,#FF0000"></a-entity>-->



<!--    <a-marker type='barcode' value='0' registerevents>-->
<!--        <a-text id="text_zero" data-infoImgSrc="g910_1.png" data-textValue="Dummy text 1"></a-text>-->

<!--            <a-portal-door url='https://cdn.aframe.io/360-image-gallery-boilerplate/img/city.jpg' position='0 0 0' scale='0.7 1 0.7' rotation='0 90 0'><a-portal-door>-->

<!--    </a-marker>-->

<!--    <a-sphere position="0 0 0" radius="0.1" opacity = "0.5" animation="property: color; dir: alternate; dur: 1000;-->
<!--                           easing: easeInSine; loop: true; to: #5F5"-->
<!--              animation__scale="property: scale; dir: alternate; dur: 200;-->
<!--                           easing: easeInSine; loop: true; to: 1.2 1 1.2"-->
<!--              animation__yoyo="property: position; dir: alternate; dur: 1000;-->
<!--                                 easing: easeInSine; loop: true; to: 0 2 0">-->
<!--        <a-sphere radius="0.1" opacity="0.5"></a-sphere>-->


<!--        </a-sphere>-->

<!--    </a-sphere>-->

            <a-entity id="pollution1" position="0 2.25 -15" particle-system="preset: dust; size: 100;  texture: ./aframe-particle-system-component/dist/images/circuitbutterfly.png;  max-particle-count: 200;"></a-entity>



    <a-marker id="animated-marker" type='barcode' value='1' registerevents>
<!--        <div id="fog"></div>-->
                <a-text id="text_one" data-textValue="RECYCLE" font="roboto" material='opacity: 0.5;'></a-text>

        <!--        <a-text id="text_one" data-infoImgSrc="g910_2.png" data-textValue="RECYCLE" font="roboto" material='opacity: 0.5;'></a-text>-->
        <a-entity animation="  property: rotation; to:0 360 0; dur: 5000; easing: linear; loop: true" gltf-model="#earth"  position="0 0 0" scale="0.05 0.05 0.05"></a-entity>

        <a-entity position="0 10 1" animation= "property: rotation; to:20 360 0; dur: 5000; easing: linear; loop: true" gltf-model="#lego" scale="0.05 0.05 0.05"></a-entity>


<!--        <a-entity id="pollution1" position="0 2.25 -15" particle-system="preset: dust; size: 10;  texture: ./aframe-particle-system-component/dist/images/ewaste.png;  particle-count: 2000; color: #FF0000"></a-entity>-->
<!--        <a-entity id="pollution2" position="0 2.25 -15" particle-system="preset: dust; size: 10;  texture: ./aframe-particle-system-component/dist/images/smoke.png;  particle-count: 2000; color: ##0000FF"></a-entity>-->
<!--        <a-entity id="pollution3" position="0 2.25 -15" particle-system="preset: dust; size: 10;  texture: ./aframe-particle-system-component/dist/images/gameboy.png;  particle-count: 2000;"></a-entity>-->
<!--        <a-entity id="pollution4" position="0 2.25 -15" particle-system="preset: dust; size: 10;  texture: ./aframe-particle-system-component/dist/images/oldtv2.png;  particle-count: 2000;"></a-entity>-->




    </a-marker>



    <a-marker id="animated-marker" type='barcode' value='0' registerevents>
        <a-text id="text_one" data-infoImgSrc="g910_3.png" data-textValue="Dummy text 3" font="roboto" material='opacity: 0.5;'></a-text>
        <a-box position='0 0.5 0' material='opacity: 0.5; side: double;color:red;'>
            <a-torus-knot radius='0.26' radius-tubular='0.05'
                          animation="property: rotation; to:360 0 0; dur: 5000; easing: linear; loop: true">
            </a-torus-knot>
        </a-box>

    </a-marker>


    <!-- use this <a-entity camera> to support multiple-markers, otherwise use <a-marker-camera> instead of </a-marker> -->
    <a-entity camera></a-entity>
</a-scene>

<script>
    document.getElementById('helloworld').addEventListener('markerFound', function (event) {
        console.log('test');

    });

</script>

</body>
</html>
